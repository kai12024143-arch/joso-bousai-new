<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>JORFOR MAP</title>
    <style>
        body { font-family: sans-serif; margin: 0; background-color: #f0f7f9; transition: 0.3s; }
        #map { height: 450px; width: 100%; border-bottom: 2px solid #ddd; }
        header { background: #fff; padding: 12px; text-align: center; border-bottom: 1px solid #eee; }
        h1 { margin: 0; font-size: 1.1rem; }
        .mode-switcher { display: flex; justify-content: center; gap: 10px; padding: 10px; background: #fff; }
        .mode-btn { padding: 8px 16px; border-radius: 20px; border: 2px solid #ddd; cursor: pointer; font-size: 0.85rem; font-weight: bold; }
        #post-form { margin: 15px; padding: 20px; background: #fff; border-radius: 15px; box-shadow: 0 2px 10px rgba(0,0,0,0.05); }
        textarea { width: 100%; height: 70px; margin-bottom: 10px; border-radius: 10px; border: 1px solid #eee; padding: 10px; font-size: 16px; box-sizing: border-box; }
        
        .file-input-wrapper { margin-bottom: 15px; text-align: center; }
        #image-preview { width: 100%; max-height: 150px; object-fit: cover; display: none; border-radius: 10px; margin-bottom: 10px; }
        
        #post-button { padding: 14px; color: white; border: none; border-radius: 10px; cursor: pointer; width: 100%; font-size: 1.1rem; font-weight: bold; }
        #post-button:disabled { background-color: #ccc !important; }

        .color-selector { display: flex; justify-content: center; gap: 15px; margin-bottom: 15px; }
        .circle-btn { width: 48px; height: 48px; border-radius: 50%; border: 3px solid transparent; cursor: pointer; transition: 0.2s; display: flex; align-items: center; justify-content: center; font-size: 1.4rem; }
        .circle-btn.selected { border-color: #333; transform: scale(1.1); box-shadow: 0 4px 8px rgba(0,0,0,0.2); }
        #btn-desc { text-align: center; font-size: 0.85rem; margin-bottom: 15px; font-weight: bold; min-height: 1.2em; display: none; }
        .c-pale-green { background: #CAFFBF; } .c-pale-blue { background: #A0C4FF; } .c-pale-yellow { background: #FDFFB6; } .c-pale-red { background: #FFADAD; }
        .c-red { background: #FF0000; } .c-yellow { background: #FFD700; } .c-green { background: #32CD32; }
        
        body.normal-mode .mode-btn.n-active { background: #4dabf7; color: white; border-color: #4dabf7; }
        body.normal-mode #post-button { background: #4dabf7; }
        body.normal-mode .emergency-ui { display: none; }
        body.emergency-mode { background-color: #2a0a0a; color: white; }
        body.emergency-mode header, body.emergency-mode .mode-switcher { background: #441111; border-color: #552222; }
        body.emergency-mode .mode-btn.e-active { background: #ff0000; color: white; border-color: #ff0000; }
        body.emergency-mode #post-form { background: #441111; }
        body.emergency-mode textarea { background: #552222; border-color: #663333; color: white; }
        body.emergency-mode #post-button { background: #ff0000; }
        body.emergency-mode .normal-ui { display: none; }
        body.emergency-mode #btn-desc { display: block; color: #ffcccc; }
        .hide-btn { margin-top: 10px; padding: 6px; background: #f8f9fa; border: 1px solid #ddd; border-radius: 6px; cursor: pointer; color: #666; font-size: 11px; width: 100%; }
        .gm-style-iw { color: #333 !important; }
        .iw-img { width: 100%; border-radius: 5px; margin-top: 8px; }
    </style>
</head>
<body class="normal-mode">
    <header><h1 id="title">JORFOR MAP</h1></header>
    <div class="mode-switcher">
        <div id="m-n" class="mode-btn n-active" onclick="switchMode('normal')">ÈÄöÂ∏∏ÊôÇ„É¢„Éº„Éâ</div>
        <div id="m-e" class="mode-btn" onclick="switchMode('emergency')">ÈùûÂ∏∏ÊôÇ„É¢„Éº„Éâ</div>
    </div>
    <div id="map"></div>
    <form id="post-form">
        <div class="normal-ui">
            <div class="color-selector">
                <div class="circle-btn c-pale-green selected" onclick="pick('pale-green', this, '')"></div>
                <div class="circle-btn c-pale-blue" onclick="pick('pale-blue', this, '')"></div>
                <div class="circle-btn c-pale-yellow" onclick="pick('pale-yellow', this, '')"></div>
                <div class="circle-btn c-pale-red" onclick="pick('pale-red', this, '')"></div>
            </div>
        </div>
        <div class="emergency-ui">
            <div class="color-selector">
                <div class="circle-btn c-red" onclick="pick('red', this, 'üö® ÊïëÂä©Ë¶ÅË´ãÔºàËá≥ÊÄ•ÔºÅÔºâ')">üö®</div>
                <div class="circle-btn c-yellow" onclick="pick('yellow', this, '‚ö†Ô∏è Ë¢´ÂÆ≥„ÅÇ„ÇäÔºàÂª∫Áâ©„ÉªÊµ∏Ê∞¥Ôºâ')">‚ö†Ô∏è</div>
                <div class="circle-btn c-green" onclick="pick('green', this, 'üçµ Ë¢´ÂÆ≥„Å™„ÅóÔºàÁÑ°‰∫ãÂ†±ÂëäÔºâ')">üçµ</div>
            </div>
            <div id="btn-desc" class="btn-guide">üö® ÊïëÂä©Ë¶ÅË´ãÔºàËá≥ÊÄ•ÔºÅÔºâ</div>
        </div>

        <input type="hidden" id="selected-val" value="pale-green">
        <img id="image-preview">
        <textarea id="post-text" placeholder="„É°„ÉÉ„Çª„Éº„Ç∏„ÇíÂÖ•Âäõ..."></textarea>
        
        <div class="file-input-wrapper">
            <input type="file" id="image-input" accept="image/*" style="display:none">
            <button type="button" onclick="document.getElementById('image-input').click()" style="background:#eee; border:1px solid #ccc; padding:5px 10px; border-radius:5px; font-size:0.8rem;">üì∏ ÂÜôÁúü„ÇíËøΩÂä†</button>
        </div>

        <button type="submit" id="post-button">ÊäïÁ®ø„Åô„Çã</button>
    </form>
    
    <script src="
